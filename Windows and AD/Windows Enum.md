## Manual Enum
### Users and Groups
```
whoami
whoami /priv
whoami /groups
net user
net user InsertUserHere
net localgroup
net localgroup "administrators"
Get-LocalGroup
Get-LocalGroupMember "administrators"
```
### System Information
```
systeminfo
wmic qfe
Get-ChildItem Env: | ft Key,Value
wmic logicaldisk get caption,description,providername
```
### Network and Firewall
```
ipconfig /all
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
route print
Get-NetRoute -AddressFamily IPv4 | ft DestinationPrefix,NextHop,RouteMetric,ifIndex
netstat -ano
arp -a
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
type C:\WINDOWS\System32\drivers\etc\hosts
netsh firewall show state
netsh firewall show config
netsh advfirewall firewall show rule name=all > firewall.txt
```
### Intersting Files
```
Get-ChildItem -Path C:\Users\ -Include *.txt,*.ini,*.pdf,*.xls,*.xlsx,*.doc,*.docx,*.log,*.config -File -Recurse -ErrorAction SilentlyContinue
Get-ChildItem -Path C:\ -Include *.kdbx,*.ini,*.log,*.config,*.xml -File -Recurse -ErrorAction SilentlyContinue
Get-Childitem -Path C:\inetpub\ -Include *.config -File -Recurse -ErrorAction SilentlyContinue
Get-Childitem -Path C:\ -Include php.ini,httpd.conf,httpd-xampp.conf,my.ini,my.cnf -File -Recurse -ErrorAction SilentlyContinue
Get-Childitem -Path C:\ -Include access.log,error.log -File -Recurse -ErrorAction SilentlyContinue
findstr /si password *.xml *.ini *.txt *.config *.log
type C:\Windows\System32\inetsrv\config\applicationHost.config
```
### Powershell History
```
Get-History
(Get-PSReadlineOption).HistorySavePath
```
### Programs and Weak Perms
```
Get-ChildItem 'C:\Program Files', 'C:\Program Files (x86)' | ft Parent,Name,LastWriteTime
Get-ChildItem -path Registry::HKEY_LOCAL_MACHINE\SOFTWARE | ft Name
icacls "C:\Program Files\*" | findstr "(F)" | findstr "Everyone"
icacls "C:\Program Files (x86)\*" | findstr "(F)" | findstr "Everyone"
icacls "C:\Program Files\*" | findstr "(F)" | findstr "BUILTIN\Users"
icacls "C:\Program Files (x86)\*" | findstr "(F)" | findstr "BUILTIN\Users"
icacls "C:\Program Files\*" | findstr "(M)" | findstr "Everyone"
icacls "C:\Program Files (x86)\*" | findstr "(M)" | findstr "Everyone"
icacls "C:\Program Files\*" | findstr "(M)" | findstr "BUILTIN\Users" 
icacls "C:\Program Files (x86)\*" | findstr "(M)" | findstr "BUILTIN\Users"
accesschk.exe /accepteula -qwsu "Everyone" *
accesschk.exe /accepteula -qwsu "Authenticated Users" *
accesschk.exe /accepteula -qwsu "Users" *
```
### Services
```
tasklist /svc
tasklist /v
Get-WmiObject -Query "Select * from Win32_Process" | where {$_.Name -notlike "svchost*"} | Select Name, Handle, @{Label="Owner";Expression={$_.GetOwner().User}} | ft -AutoSize
accesschk.exe /accepteula -uwcqv "Everyone" *
accesschk.exe /accepteula -uwcqv "Authenticated Users" *
accesschk.exe /accepteula -uwcqv "Users" *
sc qc ServiceHere
sc query ServiceHere
```
### Unquoted Service Path
```
gwmi -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where {$_.StartMode -eq "Auto" -and $_.PathName -notlike "C:\Windows*" -and $_.PathName -notlike '"*'} | select PathName,DisplayName,Name
```
### Registery
```
accesschk64.exe "%USERNAME%" -kvuqsw hklm\System\CurrentControlSet\services -accepteula
```
### Scheduled Tasks
```
schtasks /query /fo LIST /v
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
### Startup
```
wmic startup get caption,command
```
## Auto Enum
### WinPEAS
```
REG ADD HKCU\Console /v VirtualTerminalLevel /t REG_DWORD /d 1
./winpeas.exe -h
```
